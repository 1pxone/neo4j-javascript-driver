<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <style>
    body {
        font: 15px monospace;
    }
    table, th, td {
        border: 1px solid #CCC;
    }
    </style>
    <script src="neo4j.js"></script>
  </head>
  <body>
    <script>
        
    var session = new Session();

    function doStuff() {
        var statement = document.getElementById("statement").value, //"MERGE (a:Person {name:'Alice'}) RETURN a", //"RETURN 'hello, world' AS greeting",
            parameters = {};

        var li = document.createElement("li");

        var table = document.createElement("table");
        session.run(statement, parameters, function(record) {
        
            // On receipt of RECORD
            var tr = document.createElement("tr");
            for(var i = 0; i < record.length; i++) {
                var td = document.createElement("td");
                td.appendChild(document.createTextNode(record[i]));
                tr.appendChild(td);
            }
            table.appendChild(tr);
            
        }, function(success, metadata) {
        
            // On receipt of header summary message
            if(success) {
                var tr = document.createElement("tr");
                for(var i = 0; i < metadata.fields.length; i++) {
                    var th = document.createElement("th");
                    th.appendChild(document.createTextNode(metadata.fields[i]));
                    tr.appendChild(th);
                }
                table.appendChild(tr);
            }
            
        });

        li.appendChild(table);
        document.getElementById("results").appendChild(li);

    }

    </script>

    <form>
      <textarea id="statement" rows="4" cols="80">RETURN 'hello, world' AS greeting</textarea>
      <input type="button" onclick="doStuff()" value="RUN">
    </form>

    <ol id="results"></ol>

  </body>
</html>

